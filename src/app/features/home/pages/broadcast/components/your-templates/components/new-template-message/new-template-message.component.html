<app-loading-overlay
  [isVisible]="isLoading"
  title="Creating Template..."
  message="Please wait while we process your template">
</app-loading-overlay>

<app-success-message
  [isVisible]="showSuccess"
  title="Template Created Successfully!"
  message="Your WhatsApp template has been created and is ready to use.">
</app-success-message>

<div class="flex items-center  justify-center bg-gradient-to-br from-blue-50 via-white to-green-50 py-8 px-2">
  <div class="w-full max-w-6xl flex flex-col md:flex-row rounded-2xl shadow-2xl overflow-hidden bg-white/80 backdrop-blur-lg">
    <!-- Left: Form Card -->
    <div class="flex-1 p-8 bg-white rounded-l-2xl shadow-lg min-w-0">
      <form [formGroup]="templateForm" (ngSubmit)="onSubmit()" class="space-y-6">

        <!-- Template Info Section -->
        <app-template-info-section
          [form]="templateForm"
          [categories]="categories"
          [languages]="languages">
        </app-template-info-section>

        <!-- Media Upload Section -->
<form [formGroup]="templateForm" (ngSubmit)="onSubmit()">
  <app-media-upload-section
    [form]="templateForm"
    [selectedMedia]="selectedMedia"
    [mediaPreviewUrls]="mediaPreviewUrls"
    [previewMediaType]="previewMediaType"
    (mediaSelected)="onMediaSelected($event.event, $event.mediaType)">
  </app-media-upload-section>
</form>

        <!-- Body and Footer Section -->
        <app-body-footer-section
          [form]="templateForm"
          (addVariable)="onAddVariableToBody()">
        </app-body-footer-section>

        <!-- Buttons Section -->
        <app-buttons-section
          [shouldShowButtonSection]="shouldShowButtonSection"
          [showButton]="showButton"
          [buttonTypes]="buttonTypes"
          [visitWebsiteButton]="visitWebsiteButton"
          [callPhoneButton]="callPhoneButton"
          [copyOfferButton]="copyOfferButton"
          [quickReplyButton]="quickReplyButton"
          [marketingButtonRequired]="marketingButtonRequired"
          [isAuthenticationCategory]="isAuthenticationCategory"
          [form]="templateForm"
          (toggle)="onToggle($event)"
          (addButton)="onAddButton($event)"
          (deleteQuickReplyButton)="onDeleteQuickReplyButton($event)">
        </app-buttons-section>

        <!-- Form Actions -->
        <app-form-actions-section
          [form]="templateForm"
          [isLoading]="isLoading"
          [isAuthenticationCategory]="isAuthenticationCategory"
          submitButtonText="Create Template"
          cancelButtonText="Cancel"
          loadingText="Creating..."
          (submit)="onSubmit()"
          (cancel)="resetForm()">
        </app-form-actions-section>
      </form>
    </div>

    <!-- Vertical Divider -->
    <div class="hidden md:flex items-center">
      <div class="h-96 w-1 bg-gradient-to-b from-blue-200 via-gray-200 to-green-200 mx-2 rounded-full"></div>
    </div>

    <!-- Right: Preview Section -->
        <app-whatsapp-preview
          [header]="templateForm.get('text')?.value"
          [body]="templateForm.get('body')?.value || ''"
          [footer]="templateForm.get('footer')?.value || ''"
          [mediaUrl]="previewMediaUrl"
          [mediaType]="previewMediaType"
          [buttons]="previewButtons"
          [time]="''"
        ></app-whatsapp-preview>
  </div>
</div>

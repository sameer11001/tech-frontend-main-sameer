<!-- Header -->
<div class="h-24 bg-[#F5F6FF] border border-[#E6E8FF] shadow-md border-b px-8  flex items-center select-none">
  <div class="w-full flex items-center justify-between gap-4 cursor-default">
    <div class="flex items-center gap-4">
      <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
      <h1 class="text-2xl font-bold text-black">Scheduled Broadcasts</h1>
    </div>
    <div class="flex items-center gap-3">
      <!-- <span class="text-sm text-white bg-indigo-500/30 px-4 py-2 rounded-full select-none">
        {{ (filteredBroadcasts$ | async)?.length || 0 }} broadcasts
      </span> -->
      <button
        (click)="onNewBroadcast()"
        class="px-4 py-2 bg-indigo-300 border border-[#E6E8FF] hover:bg-[#4A5BD1] transition-colors shadow-md border-b text-white rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 cursor-pointer select-auto"
      >
        New Broadcast
      </button>
    </div>
  </div>
</div>

<!-- Search Bar -->
<div class="flex items-center justify-between px-6 py-4 bg-white border-b border-gray-200 select-none">
  <!-- <div class="relative">
    <input
      type="text"
      placeholder="Search by broadcast name..."
      [ngModel]="searchTerm"
      (input)="onSearchChange($event)"
      class="border border-gray-300 rounded pl-10 pr-3 py-2 w-80 focus:outline-none focus:ring-2 focus:ring-indigo-400"
    />
    <svg
      class="w-5 h-5 text-gray-400 absolute left-3 top-2.5"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      viewBox="0 0 24 24"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M21 21l-4.35-4.35m0 0A7.47 7.47 0 1010.53 3a7.47 7.47 0 006.12 13.65z"
      ></path>
    </svg>
  </div>
  <div class="text-xs text-gray-400">
    {{ (filteredBroadcasts$ | async)?.length || 0 }} of {{ (broadcasts$ | async)?.data?.length || 0 }} broadcasts
  </div> -->
</div>

<!-- Table -->
<div class="overflow-auto bg-white shadow-sm px-6">
  <table class="min-w-full divide-y divide-gray-200 text-sm text-left">
    <thead class="bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200">
      <tr>
        <th class="px-6 py-4 font-medium text-gray-700">Broadcast Name</th>
        <th class="px-6 py-4 font-medium text-gray-700">Scheduled Time</th>
        <th class="px-6 py-4 font-medium text-gray-700">Actions</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-100">
      <tr *ngIf="loading$ | async">
        <td colspan="3" class="text-center py-8 text-gray-500">Loading broadcasts...</td>
      </tr>

      <tr *ngIf="error$ | async as error">
        <td colspan="3" class="text-center py-8 text-red-500">
          Error loading broadcasts: {{ error?.error?.message || error?.message || error }}
        </td>
      </tr>

      <tr *ngIf="((filteredBroadcasts$ | async)?.length || 0) === 0 && !(loading$ | async) && !(error$ | async)">
        <td colspan="3" class="text-center py-8 text-gray-500">No broadcasts found</td>
      </tr>

      <tr *ngFor="let broadcast of (filteredBroadcasts$ | async); trackBy: trackByBroadcastId" class="hover:bg-gray-50">
        <td class="px-6 py-4 text-indigo-700 font-medium">
          {{ broadcast.name || 'No Name' }}
        </td>
        <td class="px-6 py-4 text-gray-600">{{ broadcast.scheduled_time | date:'short' }}</td>
        <td class="px-6 py-4">
          <div class="flex space-x-2">
            <button 
              (click)="onViewBroadcast(broadcast)"
              class="px-3 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 text-sm"
            >
              View
            </button>
            <button 
              (click)="onDeleteBroadcast(broadcast.id, broadcast.name)"
              [disabled]="deleteLoading$ | async"
              class="px-3 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100 text-sm disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <span *ngIf="!(deleteLoading$ | async)">Delete</span>
              <span *ngIf="deleteLoading$ | async">Deleting...</span>
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
